[gd_resource type="BehaviorTree" load_steps=56 format=3 uid="uid://divr2rf3r2i0x"]

[ext_resource type="Script" uid="uid://dr4vkyorjqaqn" path="res://ai/tasks/getPlayerPos.gd" id="1_jodhf"]
[ext_resource type="Script" uid="uid://clsympdov604o" path="res://ai/tasks/checkAgro.gd" id="2_hsdvk"]
[ext_resource type="Script" uid="uid://yu3fkdlxtfbv" path="res://ai/tasks/calcPath.gd" id="3_y6dfc"]
[ext_resource type="Script" uid="uid://dko7uh5a2dm00" path="res://ai/tasks/moveToPos.gd" id="4_arvq5"]
[ext_resource type="Script" uid="uid://c7b86gm25q0p3" path="res://ai/tasks/player_in_range.gd" id="5_y6dfc"]
[ext_resource type="Script" uid="uid://rvfhx3hd7gln" path="res://ai/tasks/attacks.gd" id="5_yg7nc"]
[ext_resource type="Script" uid="uid://danrund51c7i6" path="res://ai/tasks/chooseRandomPos.gd" id="6_2flr3"]
[ext_resource type="Script" uid="uid://ravfjih580jj" path="res://ai/tasks/moveToPlayer.gd" id="6_arvq5"]
[ext_resource type="Script" uid="uid://c0bvdm1o3wjaq" path="res://ai/tasks/random_cooldown.gd" id="8_arvq5"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_ua8f2"]
var/state/name = &"state"
var/state/type = 4
var/state/value = ""
var/state/hint = 0
var/state/hint_string = ""
var/agro_dist/name = &"agro_dist"
var/agro_dist/type = 3
var/agro_dist/value = 0.0
var/agro_dist/hint = 0
var/agro_dist/hint_string = ""
var/deagro_dist/name = &"deagro_dist"
var/deagro_dist/type = 3
var/deagro_dist/value = 0.0
var/deagro_dist/hint = 0
var/deagro_dist/hint_string = ""
var/hit_range/name = &"hit_range"
var/hit_range/type = 3
var/hit_range/value = 0.0
var/hit_range/hint = 0
var/hit_range/hint_string = ""
var/target_pos/name = &"target_pos"
var/target_pos/type = 5
var/target_pos/value = Vector2(0, 0)
var/target_pos/hint = 0
var/target_pos/hint_string = ""
var/player_idx/name = &"player_idx"
var/player_idx/type = 2
var/player_idx/value = 0
var/player_idx/hint = 0
var/player_idx/hint_string = ""

[sub_resource type="BBVariant" id="BBVariant_arvq5"]
type = 4
saved_value = "spawning"
resource_name = "spawning"

[sub_resource type="BTCheckVar" id="BTCheckVar_yg7nc"]
variable = &"state"
check_type = 5
value = SubResource("BBVariant_arvq5")

[sub_resource type="BTAction" id="BTAction_tqs8k"]
script = ExtResource("1_jodhf")

[sub_resource type="BTAction" id="BTAction_3ccgm"]
script = ExtResource("2_hsdvk")

[sub_resource type="BTSequence" id="BTSequence_4evon"]
custom_name = "Constants"
children = [SubResource("BTAction_tqs8k"), SubResource("BTAction_3ccgm")]

[sub_resource type="BBVariant" id="BBVariant_3c6mk"]
type = 4
saved_value = "agro"
resource_name = "agro"

[sub_resource type="BTCheckVar" id="BTCheckVar_nufqr"]
variable = &"state"
value = SubResource("BBVariant_3c6mk")

[sub_resource type="BBNode" id="BBNode_xsft4"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_1kwu6"]
animation_player = SubResource("BBNode_xsft4")
animation_name = &"move"

[sub_resource type="BTRunLimit" id="BTRunLimit_arvq5"]
children = [SubResource("BTPlayAnimation_1kwu6")]

[sub_resource type="BTAction" id="BTAction_xsft4"]
script = ExtResource("3_y6dfc")

[sub_resource type="BTAction" id="BTAction_1kwu6"]
script = ExtResource("4_arvq5")

[sub_resource type="BTAction" id="BTAction_v4ajl"]
script = ExtResource("8_arvq5")
min_time = 0.5
max_time = 2.0

[sub_resource type="BTAction" id="BTAction_yg7nc"]
custom_name = "OuterRange"
script = ExtResource("5_y6dfc")
hit_range = 64

[sub_resource type="BTAction" id="BTAction_2flr3"]
custom_name = "MoveToPlayer"
script = ExtResource("6_arvq5")

[sub_resource type="BTAction" id="BTAction_h7qfk"]
custom_name = "InnerRange"
script = ExtResource("5_y6dfc")

[sub_resource type="BBNode" id="BBNode_1kwu6"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTStopAnimation" id="BTStopAnimation_3ccgm"]
animation_player = SubResource("BBNode_1kwu6")
animation_name = &"move"

[sub_resource type="BBNode" id="BBNode_6xbjc"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_4evon"]
animation_player = SubResource("BBNode_6xbjc")
animation_name = &"attack"

[sub_resource type="BTAction" id="BTAction_4evon"]
script = ExtResource("5_yg7nc")

[sub_resource type="BTDelay" id="BTDelay_1kwu6"]
seconds = 0.2
children = [SubResource("BTAction_4evon")]

[sub_resource type="BBNode" id="BBNode_yg7nc"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_2flr3"]
animation_player = SubResource("BBNode_yg7nc")
animation_name = &"move"

[sub_resource type="BTDelay" id="BTDelay_arvq5"]
seconds = 0.3
children = [SubResource("BTPlayAnimation_2flr3")]

[sub_resource type="BTSequence" id="BTSequence_v4ajl"]
custom_name = "Attack if in Range"
children = [SubResource("BTAction_v4ajl"), SubResource("BTAction_yg7nc"), SubResource("BTAction_2flr3"), SubResource("BTAction_h7qfk"), SubResource("BTStopAnimation_3ccgm"), SubResource("BTPlayAnimation_4evon"), SubResource("BTDelay_1kwu6"), SubResource("BTDelay_arvq5")]

[sub_resource type="BTCooldown" id="BTCooldown_33y05"]
duration = 1.0
children = [SubResource("BTSequence_v4ajl")]

[sub_resource type="BTSequence" id="BTSequence_yg7nc"]
custom_name = "Attack"
children = [SubResource("BTAction_xsft4"), SubResource("BTAction_1kwu6"), SubResource("BTCooldown_33y05")]

[sub_resource type="BTSelector" id="BTSelector_2flr3"]
custom_name = "Animate or Not"
children = [SubResource("BTRunLimit_arvq5"), SubResource("BTSequence_yg7nc")]

[sub_resource type="BTSequence" id="BTSequence_ecge8"]
custom_name = "Attack"
children = [SubResource("BTCheckVar_nufqr"), SubResource("BTSelector_2flr3")]

[sub_resource type="BBVariant" id="BBVariant_jodhf"]
type = 4
saved_value = "agro"
resource_name = "agro"

[sub_resource type="BTCheckVar" id="BTCheckVar_hsdvk"]
variable = &"state"
check_type = 5
value = SubResource("BBVariant_jodhf")

[sub_resource type="BTAction" id="BTAction_arvq5"]
script = ExtResource("8_arvq5")

[sub_resource type="BBNode" id="BBNode_arvq5"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_yg7nc"]
animation_player = SubResource("BBNode_arvq5")
animation_name = &"move"

[sub_resource type="BTAction" id="BTAction_nufqr"]
script = ExtResource("6_2flr3")

[sub_resource type="BTAction" id="BTAction_3jwwk"]
script = ExtResource("3_y6dfc")

[sub_resource type="BTAction" id="BTAction_hnqba"]
custom_name = "moveToPos"
script = ExtResource("4_arvq5")

[sub_resource type="BBNode" id="BBNode_2flr3"]
saved_value = NodePath("AnimationPlayer")
resource_name = "AnimationPlayer"

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_h7qfk"]
animation_player = SubResource("BBNode_2flr3")
animation_name = &"idle"

[sub_resource type="BTSequence" id="BTSequence_arvq5"]
children = [SubResource("BTAction_arvq5"), SubResource("BTPlayAnimation_yg7nc"), SubResource("BTAction_nufqr"), SubResource("BTAction_3jwwk"), SubResource("BTAction_hnqba"), SubResource("BTPlayAnimation_h7qfk")]

[sub_resource type="BTCooldown" id="BTCooldown_y6dfc"]
duration = 3.0
children = [SubResource("BTSequence_arvq5")]

[sub_resource type="BTSequence" id="BTSequence_3c6mk"]
custom_name = "Patrol"
children = [SubResource("BTCheckVar_hsdvk"), SubResource("BTCooldown_y6dfc")]

[sub_resource type="BTSelector" id="BTSelector_h7qfk"]
children = [SubResource("BTSequence_ecge8"), SubResource("BTSequence_3c6mk")]

[sub_resource type="BTSequence" id="BTSequence_6xbjc"]
custom_name = "Overall Tree"
children = [SubResource("BTCheckVar_yg7nc"), SubResource("BTSequence_4evon"), SubResource("BTSelector_h7qfk")]

[resource]
blackboard_plan = SubResource("BlackboardPlan_ua8f2")
root_task = SubResource("BTSequence_6xbjc")
